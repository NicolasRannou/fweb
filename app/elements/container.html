<link rel="import" href="../bower_components/polymer-ui-elements/elements.html">

<link rel="import" href="home.html">
<link rel="import" href="research.html">
<link rel="import" href="team.html">

<polymer-element name="container-element"  attributes="">
  <template>
    <link rel="stylesheet" href="../bower_components/font-awesome/css/font-awesome.min.css">
    <style>
      @host { :scope {display: block;} }
      [main] {
        position: absolute;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
      }
      [navigation] {
        width: 256px;
        height: 100%;
      }

      [tool] {
        display: -webkit-flex;
      -webkit-flex-direction: row;

      display: flex;
      flex-direction: row;height:100% !important;
      }
      #main {
        overflow-y:scroll;
        margin-right: -20px;
      }
      polymer-ui-submenu-item{
        margin-top: -1px;
        border-top: 1px black solid;
        border-bottom: 1px black solid;
      }

      polymer-ui-submenu-item #menu{
        margin-left: 5px;
      }

      span.icon, polymer-ui-submenu-item.icon::before{
        font-weight: normal;
        font-family: "FontAwesome";
      }


      .contact{
        color: #08C
      }
      polymer-ui-submenu-item.contact::before{
        content:"\f02D";
      }
      .home{
        color: #BA55D3;
      }
      polymer-ui-submenu-item.home::before{
        content:"\f015";
      }
      .team{
        color: #08B8B8;
      }
      polymer-ui-submenu-item.team::before
{        content:"\f0c0";
      }
      .research{
        color: #0DA861
      }
      polymer-ui-submenu-item.research::before{
        content:"\f0c3";
      }
     
      polymer-ui-submenu-item  polymer-ui-menu-item{
        display:inline-block !important;
        min-width:60%
      }

      polymer-ui-menu-item:hover{
        background-color:#888
      }

      div polymer-ui-toolbar span {
        padding: 0 100px;
      }

      polymer-ui-menu {
        font-weight:normal;
        padding:0;
      }

      polymer-ui-menu-item {
        padding:0;
      }

      .enveloppe{
        height:100%;
        padding: 0 10px;
        border-right: 1px solid #FFF;
        -webkit-box-align: center;
        -ms-flex-align: center;
        -moz-align-items: center;
        -webkit-align-items: center;
        align-items: center;
        display: flex !important;
        border-right:1px solid;
        padding:0 10px;
      }

      .navTopLink{
        -webkit-box-align: center;
-ms-flex-align: center;
-moz-align-items: center;
-webkit-align-items: center;
align-items: center;display: flex !important; border-right:1px solid;border-left:1px solid; padding:0 10px;
      }

      .navTopMenu{
display: -webkit-flex;
      -webkit-flex-direction: row;

      display: flex;
      flex-direction: row;
      }

    </style>
  <polymer-ui-scaffold3 theme="polymer-ui-dark-theme" style="height:100%;position: relative;">

      <div tool flex>
        <div class="navTopLink">Boston Childrens Hospital</div>
        <div class="navTopLink">FNNDSC</div>

        <polymer-ui-toolbar class="navTopMenu" responsive>

          <!-- page navigation -->
          <span class="enveloppe">
          <polymer-ui-menu-button id="page-topnav" label="{{previousPage}}" selected="{{pageIndex}}">
            <polymer-ui-menu-item class="home icon" title="home" label="home"></polymer-ui-menu-item>
            <polymer-ui-menu-item class="research icon" title="research" label="research"></polymer-ui-menu-item>
          </polymer-ui-menu-button>
          </span>

          <!-- section navigation -->
          <!-- home section -->
          <span class="enveloppe">
          <polymer-ui-menu-button id="home-topnav" label="{{homeSection}}" selected="{{homeIndex}}">
            <template repeat="{{ home }}">
              <polymer-ui-menu-item on-tap="{{jump}}" title="home" label="{{section}}"></polymer-ui-menu-item>
            </template>
          </polymer-ui-menu-button>

          <!-- research section -->
          <polymer-ui-menu-button id="research-topnav" label="{{researchSection}}" selected="{{researchIndex}}" style="display:none;">
            <template repeat="{{ research }}">
              <polymer-ui-menu-item on-tap="{{jump}}" title="research" label="{{section}}"></polymer-ui-menu-item>
            </template>
          </polymer-ui-menu-button>
        </span>

        </polymer-ui-toolbar></div>
           
      <div on-scroll="{{scroll}}" id="main" main>

        <!-- home element -->
        <home-element id="home" reloaded="{{homeReloaded}}" scrollToSection="{{homeScroll}}"  jumpToSection="{{homeJump}}" currentSection="{{homeSection}}" currentSectionIndex="{{homeIndex}}"></home-element>

        <!-- research element -->
        <research-element id="research" reloaded="{{researchReloaded}}" scrollToSection="{{researchScroll}}" jumpToSection="{{researchJump}}" currentSection="{{researchSection}}" currentSectionIndex="{{researchIndex}}" style="display:none;"></research-element>

      </div>

      <polymer-ui-sidebar-menu navigation label="Navigation" offscreen="basement" selectedItem="{{item}}" on-polymer-select="{{sidenav}}" selected="{{pageIndexTest}}">

        <!-- home section -->
        <!-- selected="{{homeIndex}}" -->
        <polymer-ui-submenu-item class="home icon" title="home" label="Home" selected="{{homeIndexTest}}">
          <template repeat="{{ home }}">
            <polymer-ui-menu-item on-tap="{{jump}}" title="home" label="{{section}}"></polymer-ui-menu-item>
          </template>
        </polymer-ui-submenu-item>

        <!-- research section -->
        <!-- selected="{{researchIndex}}" -->
        <polymer-ui-submenu-item class="research icon" title="research" label="Research" selected="{{researchIndexTest}}">
          <template repeat="{{ research }}">
            <polymer-ui-menu-item on-tap="{{jump}}" title="research" label="{{section}}"></polymer-ui-menu-item>
          </template>
        </polymer-ui-submenu-item>

        <polymer-ui-submenu-item class="team icon" title="Meet Our Team" label="Meet Our Team">
          <polymer-ui-menu-item title="Meet Our Team" label="Faculty"></polymer-ui-menu-item>
          <polymer-ui-menu-item title="Meet Our Team" label="Staff"></polymer-ui-menu-item>
          <polymer-ui-menu-item title="Meet Our Team" label="Collaborators"></polymer-ui-menu-item>
          <polymer-ui-menu-item title="Meet Our Team" label="Alumni"></polymer-ui-menu-item>
        </polymer-ui-submenu-item>
        <polymer-ui-submenu-item class="contact icon" title="Contact Us" label="Contact Us">
          <polymer-ui-menu-item title="Contact Us" label="Boston - Main Hospital"></polymer-ui-menu-item>
          <polymer-ui-menu-item title="Contact Us" label="Boston - 1 Autumn St"></polymer-ui-menu-item>
          <polymer-ui-menu-item title="Contact Us" label="Waltham - MEG Group"></polymer-ui-menu-item>
        </polymer-ui-submenu-item>
     </polymer-ui-sidebar-menu>
    </polymer-ui-scaffold3>

  </template>
  <script>
    Polymer('container-element', {
      ready: function() {
        // selected item
        this.item = null;
        //
        this.firstLoad = 1;

        this.team = null;
        this.contact = null;


        this.pageIndexTest = null;

        // page
        this.home = [{section:'welcome', index:0},
                     {section:'about', index:1},
                     {section:'research', index:2},
                     {section:'software', index:3}];
        this.homeSection = 'welcome';
        this.homeIndex =  null;
        this.homeJump =0;
        this.homeScroll =0;
        this.homeIndexTest = null;
        this.homeReloaded = 0;

        this.research = [{section:'magnetic resonance imaging', index:0},
                         {section:'near-infrared spectroscopy', index:1},
                         {section:'magnetoencephalography', index:2},
                         {section:'software development', index:3},
                         {section:'high-performace computing', index:4}];
        this.researchSection = 'magnetic resonance imaging';
        this.researchIndex =  null;
        this.researchJump = 0;
        this.researchScroll =0;
        this.researchIndexTest = null;
        this.researchReloaded = 0;

        // navigation
        this.previousPage =  'home';
        this.pageIndex = 0;
        this.jumpReady = 0;
      },
      jump: function(){
        window.console.log('JUMP');
        this.jumpReady = 1;
        // this[this.previousPage+'Jump'] = 1;
      },
      scroll: function() {
        this[this.previousPage+'Scroll'] *= -1;
      },
      pageIndexChanged: function(){
      window.console.log("--TOP-- PAGE CHANGED");
      window.console.log(this.pageIndex);
      if(this.pageIndex != null){
      // update sidebar
      // clean up previous page section in top nav!
      this[this.previousPage+'Section'] = this[this.previousPage][0].section ;
      this[this.previousPage+'Index'] = null;

      // select page
      this.pageIndexTest = this.pageIndex;
    }
      },
      homeIndexChanged: function(){
      window.console.log("--TOP-- SECTION HOME CHANGED");
      window.console.log(this.homeIndex);
      if(this.homeIndex != null){
      // update sidebar
      // select page
      this.pageIndexTest = 0;
      // selecet section
      this.homeIndexTest = this.homeIndex;
    }
      },
      researchIndexChanged: function(){
      window.console.log("--TOP-- SECTION RESEARCH CHANGED");
      window.console.log(this.researchIndex);
      if(this.researchIndex != null){
      // update sidebar
      // select page
      this.pageIndexTest = 1;
      // selecet section
      this.researchIndexTest = this.researchIndex;
    }
      },
      sidenav: function(e, detail){
        if(detail.isSelected){
          var selectedPage = detail.item.title;

          if(selectedPage != this.previousPage){
            window.console.log("--SIDE-- PAGE");

            // hide previous page
            this.$[this.previousPage].style.display = 'none';
            this.$[this.previousPage+'-topnav'].style.display = 'none';
            // clean up previous page section in top nav!
            this[this.previousPage+'Section'] = this[this.previousPage][0].section ;
            this[this.previousPage+'IndexTest'] = null;
            this[this.previousPage+'Index'] = null;

            // show current page
            this.$[selectedPage].style.display = 'block';
            this.$[selectedPage+'-topnav'].style.display = 'block';

            // ignore the scroll event
            this[selectedPage+'Reloaded'] = 1;
            this.$.main.scrollTop = 0;


            // todo: generalize
            // selected page index
            this.previousPage = selectedPage;
            if( selectedPage == 'home'){
               this.pageIndex = 0;
             }
             else{
               this.pageIndex = 1;
             }
          }
          else{
            window.console.log("--SIDE-- SECTION");
            // find index
            var len = this[selectedPage].length;
            while (len--) {
              if(this[selectedPage][len].section == detail.item.label){
                // update topnav
                this[this.previousPage+'Index'] = len;
                this[this.previousPage+'Section'] = detail.item.label;
                // start jumping
                 if(this.jumpReady  == 1){
                    this.jumpReady = 0;
                    this[this.previousPage+'Jump'] = 1;
                 }
                break;
              }
            }
            
          }
        }
      }
    });
  </script>
</polymer-element>
