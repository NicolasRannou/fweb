<link rel="import" href="../bower_components/polymer-ui-elements/elements.html">

<link rel="import" href="home.html">
<link rel="import" href="research.html">
<link rel="import" href="highlights.html">
<link rel="import" href="software.html">
<link rel="import" href="team.html">
<link rel="import" href="contact.html">
<link rel="import" href="live.html">

<polymer-element name="container-element"  attributes="">
  <template>
    <link rel="stylesheet" href="../bower_components/font-awesome/css/font-awesome.min.css">
    <style>
      @host { :scope {display: block;} }
      [main] {
        position: absolute;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
      }
      [navigation] {
        width: 256px;
        height: 100%;
      }

      [tool] {
                -webkit-box-align: center;
-ms-flex-align: center;
-moz-align-items: center;
-webkit-align-items: center;
align-items: center;
display: -webkit-box;
  display: -moz-box;
  display: -ms-flexbox;
  display: -webkit-flex;
  display: flex;

      -webkit-flex-direction: row;
      flex-direction: row;
      height:100% !important;
-webkit-justify-content: center; 
-webkit-box-pack: center; 
  justify-content: center; 
      }
      #main {
        overflow-y:scroll;
        margin-right: -20px;
        margin-top: 39px;
      }
      polymer-ui-submenu-item{
/*        margin-top: -1px;
        border-top: 1px black solid;
        border-bottom: 1px black solid;*/
      }

      polymer-ui-submenu-item #menu{
        margin-left: 5px;
      }

      span.icon, polymer-ui-submenu-item.icon::before{
        font-weight: normal;
        font-family: "FontAwesome";
      }
      polymer-ui-submenu-item{
        color:#353535;
      }


      .home{
     /*   color: rgb(118, 218, 26)*/
        color: #353535
      }
      polymer-ui-submenu-item.home::before{
        content:"\f015";
      }
       #navTop-home.pageSelected{
background-color: #353535
}
      .research{
        color: rgb(18, 189, 79)
      }

      polymer-ui-submenu-item.research::before{
        content:"\f0c3";
      }

     #navTop-research.pageSelected{
background-color: rgb(18, 189, 79)
      }

      .highlights{
        color:rgb(26, 187, 218)
      }
          polymer-ui-submenu-item.highlights::before{
        content:"\f18c";
      }

     #navTop-highlights.pageSelected{
background-color: rgb(26, 187, 218)
      }

     .software{
        color:rgb(26, 26, 218)
      }
            polymer-ui-submenu-item.software::before{
        content:"\f085";
      }
      #navTop-software.pageSelected{
background-color:rgb(26, 26, 218)
      }

      .team{
        color:rgb(87, 26, 218)
      }
      polymer-ui-submenu-item.team::before
{        content:"\f0c0";
      }
        #navTop-team.pageSelected{
background-color:rgb(87, 26, 218)
      }

     .contact{
        color: rgb(164, 26, 218)
      }
      polymer-ui-submenu-item.contact::before{
        content:"\f02D";
      }

      #navTop-contact.pageSelected{
background-color:rgb(164, 26, 218)
      }

      .live{
        color:rgb(218, 26, 26)
      }
            polymer-ui-submenu-item.live::before{
        content:"\f03d";
      }
      
      #navTop-live.pageSelected{
background-color: rgb(218, 26, 26)
      }

      .events{
        color: rgb(218, 103, 26)
      }

      polymer-ui-submenu-item.events::before{
        content:"\f073";
      }
      
      #navTop-events.pageSelected{
background-color: rgb(218, 103, 26)
      }
         
      polymer-ui-submenu-item  polymer-ui-menu-item{
        display:inline-block !important;
        min-width:60%
      }

      polymer-ui-menu-item:hover{
        background-color:#888
      }

      div polymer-ui-toolbar span {
        padding: 0 100px;
      }

      polymer-ui-menu {
        font-weight:normal;
        padding:0;
      }

      polymer-ui-menu-item {
        padding:0;
        opacity:1;
        font-weight: normal;
      }

      .enveloppe{
        height:100%;
        padding: 0 10px;
        border-right: 1px solid #FFF;
        -webkit-box-align: center;
        -ms-flex-align: center;
        -moz-align-items: center;
        -webkit-align-items: center;
        align-items: center;
display:none;
        border-right:1px solid;
        padding:0 10px;


      }

      .enveloppe{
-webkit-transition: -webkit-text-shadow 300ms ease;
    -moz-transition: -moz-text-shadow 300ms ease;
    -o-transition: -o-text-shadow 300ms ease;
    transition: text-shadow  300ms ease;

      }

      .envP-selected{
/*        background: rgb(0, 157, 233);
#009DE9
*/
                text-shadow: 0 0 10px #FFF; /* horizontal-offset vertical-offset 'blur' colour */
      }


      .navTopLink{
        -webkit-box-align: center;
-ms-flex-align: center;
-moz-align-items: center;
-webkit-align-items: center;
align-items: center;
display: -webkit-box!important;
  display: -moz-box!important;
  display: -ms-flexbox!important;
  display: -webkit-flex!important;
  display: flex!important;

padding:0 10px;
        height:100%;
        color:grey;
      }

      #topNav{
        -webkit-box-align: center;
-ms-flex-align: center;
-moz-align-items: center;
-webkit-align-items: center;
align-items: center;
display: -webkit-box!important;
  display: -moz-box!important;
  display: -ms-flexbox!important;
  display: -webkit-flex!important;
  display: flex!important;
                height:100%;

                font-size:18px;

      }

            .navTopLink:hover{
/*background:#FFF!important;*/
color: #353535;
cursor: pointer;
      }

      .navTopMenu{
display: -webkit-box;
  display: -moz-box;
  display: -ms-flexbox;
  display: -webkit-flex;
  display: flex;

      -webkit-flex-direction: row;
      flex-direction: row;
      }

      #envS2{
/*        position: fixed;
bottom: 100px;
height: 60px;
z-index: 15;
right: 10px;*/
      }

            .eightNav{
        position: fixed;
z-index: 15;
                -webkit-box-align: center;
-ms-flex-align: center;
-moz-align-items: center;
-webkit-align-items: center;
align-items: center;
display: -webkit-box;
  display: -moz-box;
  display: -ms-flexbox;
  display: -webkit-flex;
  display: flex;

      -webkit-flex-direction: row;
      flex-direction: row;
      width:100% !important;
-webkit-justify-content: center; 
-webkit-box-pack: center; 
  justify-content: center;
        background-color: #FFF;
        font-size: 16px;
border-bottom-width: 1px;
border-bottom-style: solid;
border-bottom-color: rgba(0, 0, 0, 0.14902);
      }

      .section-selected{
        text-decoration: underline;
color:#353535;
      }

            .pageSelected{
color:#FFF!important;
      }


      .section-right{
               padding:9px; 
      }

      .section-right:hover{
        cursor:pointer;
        background: rgb(242, 242, 242);
      }

polymer-ui-toolbar{
  height:50px!important;
}
      polymer-ui-toolbar.polymer-ui-light-theme{
        background-color: rgb(242, 242, 242)!important;
      }

      polymer-ui-sidebar-menu{
        background: rgb(242, 242, 242) !important;

      }

.right-container{
                -webkit-box-align: center;
-ms-flex-align: center;
-moz-align-items: center;
-webkit-align-items: center;
align-items: center;
display: -webkit-box;
  display: -moz-box;
  display: -ms-flexbox;
  display: -webkit-flex;
  display: flex;

      -webkit-flex-direction: row;
      flex-direction: row;
-webkit-justify-content: center; 
-webkit-box-pack: center; 
  justify-content: center; 
/*        border-right:1px solid;*/
        background-color: #FFF;
}

.flexDisplay{
          -webkit-box-align: center;
-ms-flex-align: center;
-moz-align-items: center;
-webkit-align-items: center;
align-items: center;
display: -webkit-box!important;
  display: -moz-box!important;
  display: -ms-flexbox!important;
  display: -webkit-flex!important;
  display: flex!important;

padding:0 10px;
        height:100%;
        color:grey;
}
    </style>
  <polymer-ui-scaffold3 theme="polymer-ui-light-theme" style="height:100%;position: relative;">


            <div id="rightNav" class="eightNav" style="color:black;">
            <div id="right-container-home" class="right-container">
              <div class="flexDisplay">
              <template repeat="{{ home }}">
                <div data-section='{{id}}' class="home {{id}}-right section-right" on-tap="{{verticalMenu}}">{{label}}</div>
              </template>
            </div>
            </div>
            <div id="right-container-research" class="right-container" style="display:none">
              <div class="flexDisplay">
             <template repeat="{{ research }}">
                <div data-section='{{id}}' class="research {{id}}-right section-right" on-tap="{{verticalMenu}}">{{label}}</div>
              </template>
            </div>
            </div>
            <div id="right-container-highlights" class="right-container" style="display:none">
              <div class="flexDisplay">
              <template repeat="{{ highlights }}">
                <div data-section='{{id}}' class="highlights {{id}}-right section-right" on-tap="{{verticalMenu}}">{{label}}</div>
              </template>
            </div>
            </div>
            <div id="right-container-software" class="right-container" style="display:none">
              <div class="flexDisplay">
              <template repeat="{{ software }}">
                <div data-section='{{id}}' class="software {{id}}-right section-right" on-tap="{{verticalMenu}}">{{label}}</div>
              </template>
            </div>
            </div>
            <div id="right-container-team" class="right-container" style="display:none">
              <div class="flexDisplay">
              <template repeat="{{ team }}">
                <div data-section='{{id}}' class="team {{id}}-right section-right" on-tap="{{verticalMenu}}">{{label}}</div>
              </template>
            </div>
            </div>
            <div id="right-container-contact" class="right-container" style="display:none">
              <div class="flexDisplay">
              <template repeat="{{ contact }}">
                <div data-section='{{id}}' class="contact {{id}}-right section-right" on-tap="{{verticalMenu}}">{{label}}</div>
              </template>
            </div>
            </div>
            <div id="right-container-live" class="right-container" style="display:none">
              <div class="flexDisplay">
              <template repeat="{{ live }}">
                <div data-section='{{id}}' class="live {{id}}-right section-right" on-tap="{{verticalMenu}}">{{label}}</div>
              </template>
            </div>
            </div>
            <div id="right-container-events" class="right-container" style="display:none">
              <div class="flexDisplay">
              <template repeat="{{ events }}">
                <div data-section='{{id}}' class="events {{id}}-right section-right" on-tap="{{verticalMenu}}">{{label}}</div>
              </template>
            </div>
            </div>
          </div>


      <div tool flex>
        <div id="topNav">
             <template repeat="{{ pages }}">
                      <div id='navTop-{{id}}' data-page='{{id}}' class="navTopLink page-top" on-tap="{{horizontalMenu}}">{{label}}</div>

            </template>
          </div>

        <polymer-ui-toolbar class="navTopMenu" responsive>

          <!-- page navigation -->
           <span id="envP" class="enveloppe">
          <polymer-ui-menu-button id="page-topnav" label="{{previousPageLabel}}" selected="{{pageIndexTop}}" >
            <template repeat="{{ pages }}">
              <polymer-ui-menu-item class="{{id}} icon" title="{{label}}" label="{{label}}"></polymer-ui-menu-item>
            </template>
          </polymer-ui-menu-button>
          </span>

          <!-- section navigation -->

          <!-- home section -->
          <span id="envS" class="enveloppe envS">
          <polymer-ui-menu-button id="home-topnav" label="{{homeSection}}" selected="{{homeIndexTop}}">
            <template repeat="{{ home }}">
              <polymer-ui-menu-item on-tap="{{jump}}" title="home" label="{{label}}"></polymer-ui-menu-item>
            </template>
          </polymer-ui-menu-button>

          <!-- research section -->
         <polymer-ui-menu-button id="research-topnav" label="{{researchSection}}" selected="{{researchIndexTop}}" style="display:none">
            <template repeat="{{ research }}">
              <polymer-ui-menu-item on-tap="{{jump}}" title="research" label="{{label}}"></polymer-ui-menu-item>
            </template>
          </polymer-ui-menu-button>

          <!-- highlights and awards section -->
          <polymer-ui-menu-button id="highlights-topnav" label="{{highlightsSection}}" selected="{{highlightsIndexTop}}" style="display:none">
            <template repeat="{{ highlights }}">
              <polymer-ui-menu-item on-tap="{{jump}}" title="highlights" label="{{label}}"></polymer-ui-menu-item>
            </template>
          </polymer-ui-menu-button>

          <!-- software section -->
          <polymer-ui-menu-button id="software-topnav" label="{{softwareSection}}" selected="{{softwareIndexTop}}" style="display:none">
            <template repeat="{{ software }}">
              <polymer-ui-menu-item on-tap="{{jump}}" title="software" label="{{label}}"></polymer-ui-menu-item>
            </template>
          </polymer-ui-menu-button>

          <!-- team section -->
          <polymer-ui-menu-button id="team-topnav" label="{{teamSection}}" selected="{{teamIndexTop}}" style="display:none">
            <template repeat="{{ team }}">
              <polymer-ui-menu-item on-tap="{{jump}}" title="team" label="{{label}}"></polymer-ui-menu-item>
            </template>
          </polymer-ui-menu-button>

          <!-- contact section -->
          <polymer-ui-menu-button id="contact-topnav" label="{{contactSection}}" selected="{{contactIndexTop}}" style="display:none">
            <template repeat="{{ contact }}">
              <polymer-ui-menu-item on-tap="{{jump}}" title="contact" label="{{label}}"></polymer-ui-menu-item>
            </template>
          </polymer-ui-menu-button>

          <!-- live section -->
          <polymer-ui-menu-button id="live-topnav" label="{{liveSection}}" selected="{{liveIndexTop}}" style="display:none">
            <template repeat="{{ live }}">
              <polymer-ui-menu-item on-tap="{{jump}}" title="live" label="{{label}}"></polymer-ui-menu-item>
            </template>
          </polymer-ui-menu-button>

          <!-- events section -->
          <polymer-ui-menu-button id="events-topnav" label="{{eventsSection}}" selected="{{eventsIndexTop}}" style="display:none">
            <template repeat="{{ events }}">
              <polymer-ui-menu-item on-tap="{{jump}}" title="events" label="{{label}}"></polymer-ui-menu-item>
            </template>
          </polymer-ui-menu-button>
        </span>
 </polymer-ui-toolbar>
      </div>
           
      <div on-scroll="{{scroll}}" id="main" main>

        <!-- home element -->
        <home-element id="home" reloaded="{{homeReloaded}}" scrollToSection="{{homeScroll}}"  jumpToSection="{{homeJump}}" currentSection="{{homeSection}}" currentSectionIndex="{{homeIndexTop}}"></home-element>

        <!-- research element -->
        <research-element id="research" reloaded="{{researchReloaded}}" scrollToSection="{{researchScroll}}" jumpToSection="{{researchJump}}" currentSection="{{researchSection}}" currentSectionIndex="{{researchIndexTop}}" style="display:none;"></research-element>

        <!-- publication element -->
        <highlights-element id="highlights" reloaded="{{highlightsReloaded}}" scrollToSection="{{highlightsScroll}}" jumpToSection="{{highlightsJump}}" currentSection="{{highlightsSection}}" currentSectionIndex="{{highlightsIndexTop}}" style="display:none;"></highlights-element>

        <!-- software element -->
        <software-element id="software" reloaded="{{softwareReloaded}}" scrollToSection="{{softwareScroll}}" jumpToSection="{{softwareJump}}" currentSection="{{softwareSection}}" currentSectionIndex="{{softwareIndexTop}}" style="display:none;"></software-element>

        <!-- team element -->
        <team-element id="team" reloaded="{{teamReloaded}}" scrollToSection="{{teamScroll}}" jumpToSection="{{teamJump}}" currentSection="{{teamSection}}" currentSectionIndex="{{teamIndexTop}}" style="display:none;"></team-element>

        <!-- contact element -->
        <contact-element id="contact" reloaded="{{contactReloaded}}" scrollToSection="{{contactScroll}}" jumpToSection="{{contactJump}}" currentSection="{{contactSection}}" currentSectionIndex="{{contactIndexTop}}" style="display:none;"></contact-element>

        <!-- live element -->
        <live-element id="live" reloaded="{{liveReloaded}}" scrollToSection="{{liveScroll}}" jumpToSection="{{liveJump}}" currentSection="{{liveSection}}" currentSectionIndex="{{liveIndexTop}}" style="display:none;"></live-element>

        <!-- calendar element-->
        <div id="events" style="display:none;height:100%;"><div style="margin: 0px auto!important;width: 80%;height: 100%;display: block; "><iframe src="https://www.google.com/calendar/embed?showTitle=0&amp;wkst=2&amp;bgcolor=%23FFFFFF&amp;src=admin%40babymri.org&amp;color=%232952A3&amp;ctz=America%2FNew_York" style="border-width:0; width: 100%;height:100%;" frameborder="0" scrolling="no"></iframe></div></div>

      </div>

      <polymer-ui-sidebar-menu navigation label="Navigation" offscreen="basement" selectedItem="{{item}}" on-polymer-select="{{sidenav}}" selected="{{pageIndexSide}}">

        <!-- home section -->
        <polymer-ui-submenu-item class="home icon" title="home" label="Home" selected="{{homeIndexSide}}">
          <template repeat="{{ home }}">
            <polymer-ui-menu-item on-tap="{{jump}}" title="home" label="{{label}}" data-section="{{id}}"></polymer-ui-menu-item>
          </template>
        </polymer-ui-submenu-item>

        <!-- research section -->
        <polymer-ui-submenu-item class="research icon" title="research" label="Research" selected="{{researchIndexSide}}">
          <template repeat="{{ research }}">
            <polymer-ui-menu-item on-tap="{{jump}}" title="research" label="{{label}}" data-section="{{id}}"></polymer-ui-menu-item>
          </template>
        </polymer-ui-submenu-item>

        <!-- highlights section -->
        <polymer-ui-submenu-item class="highlights icon" title="highlights" label="Highlights" selected="{{highlightsIndexSide}}">
          <template repeat="{{ highlights }}">
            <polymer-ui-menu-item on-tap="{{jump}}" title="highlights" label="{{label}}" data-section="{{id}}"></polymer-ui-menu-item>
          </template>
        </polymer-ui-submenu-item>

        <!-- software section -->
        <polymer-ui-submenu-item class="software icon" title="software" label="Software" selected="{{softwareIndexSide}}">
          <template repeat="{{ software }}">
            <polymer-ui-menu-item on-tap="{{jump}}" title="software" label="{{label}}" data-section="{{id}}"></polymer-ui-menu-item>
          </template>
        </polymer-ui-submenu-item>

        <!-- team section -->
        <polymer-ui-submenu-item class="team icon" title="team" label="Meet our team" selected="{{teamIndexSide}}">
          <template repeat="{{ team }}">
            <polymer-ui-menu-item on-tap="{{jump}}" title="team" label="{{label}}" data-section="{{id}}"></polymer-ui-menu-item>
          </template>
        </polymer-ui-submenu-item>

        <!-- contact section -->
        <polymer-ui-submenu-item class="contact icon" title="contact" label="Contact us" selected="{{contactIndexSide}}">
          <template repeat="{{ contact }}">
            <polymer-ui-menu-item on-tap="{{jump}}" title="contact" label="{{label}}" data-section="{{id}}"></polymer-ui-menu-item>
          </template>
        </polymer-ui-submenu-item>

        <!-- live section -->
        <polymer-ui-submenu-item class="live icon" title="live" label="Live" selected="{{liveIndexSide}}">
          <template repeat="{{ live }}">
            <polymer-ui-menu-item on-tap="{{jump}}" title="live" label="{{label}}" data-section="{{id}}"></polymer-ui-menu-item>
          </template>
        </polymer-ui-submenu-item>

        <!-- events section -->
        <polymer-ui-submenu-item class="events icon" title="events" label="Events" selected="{{eventsIndexSide}}">
          <template repeat="{{ events }}">
            <polymer-ui-menu-item on-tap="{{jump}}" title="events" label="{{label}}" data-section="{{id}}"></polymer-ui-menu-item>
          </template>
        </polymer-ui-submenu-item>

     </polymer-ui-sidebar-menu>
    </polymer-ui-scaffold3>

  </template>
  <script>
    Polymer('container-element', {
      ready: function() {
        // list the pages
        this.pages = [{id:'home', label:'home', index:0},
                     {id:'research', label:'research', index:1},
                     {id:'highlights', label:'highlights', index:2},
                     {id:'software', label:'software', index:3},
                     {id:'team', label:'meet our team', index:4},
                     {id:'contact', label:'contact us', index:5},
                     {id:'live', label:'on air', index:6},
                     {id:'events', label:'events', index:7}];

        // home page
        this.home = [{id:'welcome', label:'welcome',index:0}];
        this.initPageVars('home', this.home);

        // research page
        this.research = [{id:'challenges', label:'challenges', index:0},
                         {id:'mri', label:'mri', index:1},
                         {id:'nirs', label:'nirs', index:2},
                         {id:'meg', label:'meg', index:3}];
        this.initPageVars('research', this.research);

        // highlights a and awards page
        this.highlights = [{id:'highlights', label:'highlights', index:0},
                         {id:'ttfourteen', label:'2014', index:1},
                         {id:'ttthirteen', label:'2013', index:2},
                         {id:'tttwelve', label:'2012', index:3},
                         {id:'tteleven', label:'2011', index:4}];
        this.initPageVars('highlights', this.highlights);

        // software page
        this.software = [{id:'labbook', label:'The Web LabBook', index:0},
                         {id:'slicedrop', label:'SliceDrop', index:1},
                         {id:'xtk', label:'The X-Toolkit', index:2},
                         {id:'more', label:'More', index:3}];
        this.initPageVars('software', this.software);

        // team page
        this.team = [{id:'faculty', label:'faculty', index:0},
                     {id:'staff', label:'staff', index:1},
                     {id:'collaborators', label:'collaborators', index:2},
                     {id:'alumni', label:'alumni', index:3}];
        this.initPageVars('team', this.team);

        // contact page
        this.contact = [{id:'main', label:'main campus', index:0},
                     {id:'autumn', label:'1 autumn street', index:1},
                     {id:'waltham', label:'waltham', index:2}];
        this.initPageVars('contact', this.contact);

        // live page
        this.live = [{id:'live', label:'Live', index:0},
        {id:'previous', label:'Previous', index:1}];
        this.initPageVars('live', this.live);

        // live page
        this.events = [{id:'calendar', label:'calendar', index:0}];
        this.initPageVars('events', this.events);

        // navigation
        this.previousPage =  'home';
        this.previousPageLabel =  'Home';
        this.pageIndexTop = null;
        this.jumpReady = 0;
        this.pageIndexSide = null;

        $(this.$.envP).on(
    "transitionend MSTransitionEnd webkitTransitionEnd oTransitionEnd",
    function() {
        $(this).removeClass("envP-selected");
    }
);

        $(this.$.envS).on(
    "transitionend MSTransitionEnd webkitTransitionEnd oTransitionEnd",
    function() {
        $(this).removeClass("envP-selected");
    }
);

      },
      horizontalMenu: function(e, detail){

        window.console.log("H menu clicked");

        var id = e.target.getAttribute('data-page');
        $(this.$.topNav).find('.pageSelected').removeClass("pageSelected");
        $(this.$.topNav).find('#navTop-'+id).addClass("pageSelected");

        var len = this.pages.length;
        while (len--) {
          if(this.pages[len].id == id){
            this.pageIndexTop = len;
            break;
          }
        }
      },
      verticalMenu: function(e, detail){

        window.console.log("V menu clicked");

        // previous index: unselect it!
        var id = e.target.getAttribute('data-section');
        if(this[this.previousPage+'IndexTop'] != null){
          $(this.$.rightNav).find('.section-selected').removeClass("section-selected");
        }

        $(this.$.rightNav).find('.'+this.previousPage+'.'+id+'-right').addClass("section-selected");

        var len = this[this.previousPage].length;

        while (len--) {

          if(this[this.previousPage][len].id == id){

            // update topnav
            this[this.previousPage+'IndexTop'] = len;
            this[this.previousPage+'Section'] = id;

            // start jumping
            this.jumpReady = 0;
            this[this.previousPage+'Jump'] += 1;

            break;
          }
        }
      },
      initPageVars: function(pageName, pageObject){

        window.console.log("Init page");
if(pageObject[0] != null){
        this[pageName+'Section'] = pageObject[0].id;
      }
        this[pageName+'IndexTop'] =  null;
        this[pageName+'Jump'] = 0;
        this[pageName+'Scroll'] =0;
        this[pageName+'IndexSide'] = null;
        this[pageName+'Reload'] = 0;
      },
      jump: function(){
        this.jumpReady = 1;
      },
      scroll: function() {
        this[this.previousPage+'Scroll'] *= -1;
      },
      pageIndexTopChanged: function(){

      window.console.log("Page index Top changed");
      window.console.log(this.pageIndexTop);

      if(this.pageIndexTop != null){

        $(this.$.envP).toggleClass('envP-selected');

        // update topbar
        $(this.$.topNav).find('.pageSelected').removeClass("pageSelected");
        $(this.$.topNav).find('#navTop-'+this.pages[this.pageIndexTop].id).addClass("pageSelected");

        // update rightbar
        $(this.$.rightNav).find('.right-container').hide();
        $(this.$.rightNav).find('#right-container-'+this.pages[this.pageIndexTop].id).show();


        // update sidebar
        // clean up previous page section in top nav!
        this[this.previousPage+'Section'] = this[this.previousPage][0].section ;
        this[this.previousPage+'IndexTop'] = null;

        // select page
        this.pageIndexSide = this.pageIndexTop;
        }
      },
      homeIndexTopChanged: function(){

      if(this.homeIndexTop != null){

        $(this.$.envS).toggleClass('envP-selected');

        // update rightbar
        $(this.$.rightNav).find('.section-selected').removeClass("section-selected");
        $(this.$.rightNav).find('.'+this.previousPage+'.'+this.home[this.homeIndexTop].id+'-right').addClass("section-selected");

        // update sidebar
        // select page
        this.pageIndexSide = 0;
        // select section
        this.homeIndexSide = this.homeIndexTop;
        }
      },
      researchIndexTopChanged: function(){

      if(this.researchIndexTop != null){

        $(this.$.envS).toggleClass('envP-selected');

        // update rightbar
        $(this.$.rightNav).find('.section-selected').removeClass("section-selected");
        $(this.$.rightNav).find('.'+this.previousPage+'.'+this.research[this.researchIndexTop].id+'-right').addClass("section-selected");

        // update sidebar
        // select page
        this.pageIndexSide = 1;
        // select section
        this.researchIndexSide = this.researchIndexTop;
        }
      },
      highlightsIndexTopChanged: function(){

      if(this.highlightsIndexTop != null){

        $(this.$.envS).toggleClass('envP-selected');

        // update rightbar
        $(this.$.rightNav).find('.section-selected').removeClass("section-selected");
        $(this.$.rightNav).find('.'+this.previousPage+'.'+this.highlights[this.highlightsIndexTop].id+'-right').addClass("section-selected");

        // update sidebar
        // select page
        this.pageIndexSide = 2;
        // select section
        this.highlightsIndexSide = this.highlightsIndexTop;
        }
      },
      softwareIndexTopChanged: function(){

      if(this.softwareIndexTop != null){

        $(this.$.envS).toggleClass('envP-selected');

        // update rightbar
        $(this.$.rightNav).find('.section-selected').removeClass("section-selected");
        $(this.$.rightNav).find('.'+this.previousPage+'.'+this.software[this.softwareIndexTop].id+'-right').addClass("section-selected");

        // update sidebar
        // select page
        this.pageIndexSide = 3;
        // select section
        this.softwareIndexSide = this.softwareIndexTop;
        }
      },
      teamIndexTopChanged: function(){

      if(this.teamIndexTop != null){

        $(this.$.envS).toggleClass('envP-selected');

        // update rightbar
        $(this.$.rightNav).find('.section-selected').removeClass("section-selected");
        $(this.$.rightNav).find('.'+this.previousPage+'.'+this.team[this.teamIndexTop].id+'-right').addClass("section-selected");

        // update sidebar
        // select page
        this.pageIndexSide = 4;
        // select section
        this.teamIndexSide = this.teamIndexTop;
        }
      },
      contactIndexTopChanged: function(){

      if(this.contactIndexTop != null){

        $(this.$.envS).toggleClass('envP-selected');

        // update rightbar
        $(this.$.rightNav).find('.section-selected').removeClass("section-selected");
        $(this.$.rightNav).find('.'+this.previousPage+'.'+this.contact[this.contactIndexTop].id+'-right').addClass("section-selected");

        // update sidebar
        // select page
        this.pageIndexSide = 5;
        // select section
        this.contactIndexSide = this.contactIndexTop;
        }
      },
      liveIndexTopChanged: function(){

      if(this.liveIndexTop != null){

        $(this.$.envS).toggleClass('envP-selected');

        // update rightbar
        $(this.$.rightNav).find('.section-selected').removeClass("section-selected");
        $(this.$.rightNav).find('.'+this.previousPage+'.'+this.live[this.liveIndexTop].id+'-right').addClass("section-selected");

        // update sidebar
        // select page
        this.pageIndexSide = 6;
        // select section
        this.liveIndexSide = this.liveIndexTop;
        }
      },
      eventsIndexTopChanged: function(){

      if(this.eventsIndexTop != null){

        $(this.$.envS).toggleClass('envP-selected');

        // update rightbar
        $(this.$.rightNav).find('.section-selected').removeClass("section-selected");
        $(this.$.rightNav).find('.'+this.previousPage+'.'+this.events[this.eventsIndexTop].id+'-right').addClass("section-selected");

        // update sidebar
        // select page
        this.pageIndexSide = 7;
        // select section
        this.eventsIndexSide = this.eventsIndexTop;
        }
      },
      sidenav: function(e, detail){

window.console.log("Side nav changed");

        if(detail.isSelected){
          var selectedPage = detail.item.title;

          if(selectedPage != this.previousPage){
            // hide previous page
            this.$[this.previousPage].style.display = 'none';
            this.$[this.previousPage+'-topnav'].style.display = 'none';
            // clean up previous page section in top nav!
            this[this.previousPage+'Section'] = this[this.previousPage][0].section ;
            this[this.previousPage+'IndexSide'] = null;
            this[this.previousPage+'IndexTop'] = null;

            // show current page
            this.$[selectedPage].style.display = 'block';
            this.$[selectedPage+'-topnav'].style.display = 'block';

            // ignore the scroll event
            this[selectedPage+'Reloaded'] = 1;
            this.$.main.scrollTop = 0;

            // selected page index
            this.previousPage = selectedPage;
            var len = this.pages.length;

            while (len--) {

              if(this.pages[len].id == selectedPage){
                this.pageIndexTop = len;
                this.previousPageLabel = this.pages[len].label;
                break;
              }
            }

          }
          else{
            // find index
            var len = this[selectedPage].length;

            window.console.log(detail.item);

            while (len--) {

              if(this[selectedPage][len].id == detail.item.getAttribute('data-section')){
                // update topnav
                this[this.previousPage+'IndexTop'] = len;
                this[this.previousPage+'Section'] = detail.item.label;

                // start jumping
                 if(this.jumpReady  == 1){
                    this.jumpReady = 0;
                    this[this.previousPage+'Jump'] = 1;
                 }
                break;
              }
            }
            
          }
        }
      }
    });
  </script>
</polymer-element>
